---
description: 
globs: 
alwaysApply: true
---
## Core Features

### Dashboard Overview
- **Portfolio Summary:**
  - Current BTC Holdings
  - Portfolio Value (USD)
  - Cost Basis
  - Unrealized Gains/Losses
  - ROI Percentage

- **Performance Charts:**
  - Portfolio Value Over Time
  - Cost Basis Line
  - BTC Price Overlay
  - Time Range Filters (1M, 3M, 6M, 1Y, All)

- **Recent Activity:**
  - Last 5 Transactions
  - Quick Stats
  - Alert Notifications

### Portfolio Analysis
- **Holdings Breakdown:**
  - BTC Accumulation by Year (Pie Chart)
  - Average Buy Price by Year
  - Percentage of Portfolio by Entry Price

- **Cost Basis Methods:**
  - FIFO (First In, First Out)
  - LIFO (Last In, First Out)
  - Average Cost
  - Method Comparison View

- **Performance Metrics:**
  - 24h Change
  - 30d Change
  - YTD Performance
  - All-Time High/Low

### Transaction Management
- **Transaction List:**
  - Sortable Columns
  - Date Range Filter
  - Type Filter (Buy/Sell/Send/Receive)
  - Export to CSV

- **Import Capabilities:**
  - CSV File Upload
  - Manual Entry Form
  - Bulk Import Support
 
- **Data Validation:**
  - Real-time Error Checking
  - Format Verification
  - Duplicate Detection
  - Balance Verification

### Import Workflow
1. **File Selection:**
   - Drag & Drop Support
   - File Size Check (â‰¤ 10MB)
   - Format Validation
   - Initial Header Check

2. **Data Preview:**
   - First 5 Rows Display
   - Column Mapping
   - Error Highlighting
   - Summary Statistics

3. **Validation Process:**
   - Header Verification
   - Data Type Checking
   - Business Rule Validation
   - Error Reporting

4. **Import Execution:**
   - Progress Indication
   - Error Handling
   - Success Confirmation
   - Rollback Capability

5. **Post-Import:**
   - Import Summary
   - Updated Portfolio View
   - Transaction List Refresh
   - Error Resolution Options

### Data Management
- **Backup & Recovery:**
  - Export All Data
  - Transaction History
  - Portfolio Snapshots

- **Data Cleanup:**
  - Delete Transactions
  - Bulk Operations
  - Filter-based Deletion
  - Audit Trail

### Security Features
- **User Authentication:**
  - Email/Password Login
  - Session Management
  - Password Recovery
  - Account Settings

- **Data Protection:**
  - Row Level Security
  - Secure API Calls
  - Rate Limiting

### External Integrations
- **Price Data:**
  - Coinpaprika API Integration (for current price and ATH)
  - Price History Cache (in Supabase `bitcoin_prices` table)
  - Fallback Sources (consider adding logic if Coinpaprika fails)

- **Payment Processing:**
  - Stripe Integration
  - Subscription Management
  - Payment History
  - Invoice Generation

### Dashboard Menu Features
- **Overview:**
  - Display portfolio value, total cost basis, unrealized gains, and average buy price.
  - Include drill-down links to detailed views for each metric.
- **Performance:**
  - Show ROI over time, total fees paid, and filterable time periods (e.g., 1M, 1Y, All).
  - Use Chart.js for responsive performance charts.
- **Portfolio Details:**
  - Pie chart showing the majority percentage of Bitcoin bought per year.
  - Support data from 2009 (Bitcoin's inception) onward.
- **Cost Basis Method Comparison:**
  - Offer FIFO, LIFO, and average cost methods for comparison.
  - Recalculate dynamically based on user selection.
- **Recent Transactions:**
  - Table with pagination, sortable columns (e.g., date, amount), and export option.

  ### Performance Menu Features
- **KPI Tiles:**
  - ROI Tile 
  - 30 Day Change Calcuation 
  - YTD Change 
  - All time high BTC price cached until new all time price is hit

- **Performance over time chart**
  - Portfolio Value 
  - Cost Basis 
  - Filter (1M, 3M, 6M, 1Y, All)
    
  ### Portfolio Menu 
- **KPI Tiles:**
  - Total Bitcoin 
  - Total Fees Paid 
  - First Purchase 

- **BitCoin Accumulation by Year**
  - Summary by pie graph 

- **Cost Basis Method Comparison** 
  - FIFO, LIFO, Average Cost
  - KPI Tiles that filter depending on which is selected

  ### Transactions Menu 
- **Transaction History** 
  - Search transactions 
  - Have a filter by date range option
  - Display rows of most recent transactions 
  - Export all data out to CSV
  - Create a repo of all recent uploads 
  - Allow transaction deletion
  - Allow bulk clear data for adjustable options

### Import Data
- **Import options** 
  - Support multiple CSV formats:
    - Custom formatted CSVs
    - Manual transaction entry
  
  - CSV Requirements:
    - Transaction Types: Buy, Sell, Send, Receive
    - Currencies: USD and BTC only

  - Import Process:
    - File validation (size, format)
    - Header validation
    - Data transformation
    - Preview before import
    - Batch processing

  - Error Handling:
    - Clear validation messages
    - Row-level error reporting
    - Ability to fix and retry

  - Success Feedback:
    - Transaction count
    - Summary of imported data
    - Option to undo import


### Accounting Settings
- Allow users to manage subscriptions and cancel via Stripe API.
- Minimize stored user info (e.g., only `id`, `email` in Supabase).
- Sensitive data (e.g., billing info) maintained at Stripe level.


### Navigation
- **Sidebar:**
  - Links to Overview, Performance, Portfolio Details, Settings.
- **Drill-Down Links:**
  - Embed clickable elements in Overview linking to detailed sections.



  
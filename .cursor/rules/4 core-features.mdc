---
description: Core feature
globs: 
alwaysApply: false
---
## Core Features
### Dashboard Menu Features
- **Overview:**
  - Display portfolio value, total cost basis, unrealized gains, and average buy price.
  - Include drill-down links to detailed views for each metric.
- **Performance:**
  - Show ROI over time, total fees paid, and filterable time periods (e.g., 1M, 1Y, All).
  - Use Chart.js for responsive performance charts.
- **Portfolio Details:**
  - Pie chart showing the majority percentage of Bitcoin bought per year.
  - Support data from 2009 (Bitcoinâ€™s inception) onward.
- **Cost Basis Method Comparison:**
  - Offer FIFO, LIFO, and average cost methods for comparison.
  - Recalculate dynamically based on user selection.
- **Recent Transactions:**
  - Table with pagination, sortable columns (e.g., date, amount), and export option.

  ### Performance Menu Features
- **KPI Tiles:**
  - ROI Tile 
  - 30 Day Change Calcuation 
  - YTD Change 
  - All time high BTC price cached until new all time price is hit

- **Performance over time chart**
  - Portfolio Value 
  - Cost Basis 
  - Filter (1M, 3M, 6M, 1Y, All)
    
  ### Portfolio Menu 
- **KPI Tiles:**
  - Total Bitcoin 
  - Total Fees Paid 
  - First Purchase 

- **BitCoin Accumulation by Year**
  - Summary by year Bar Graph
  - Summary by pie graph 

- **Cost Basis Method Comparison** 
  - FIFO, LIFO, Average Cost
  - KPI Tiles that filter depending on which is selected

  ### Transactions Menu 
- **Transaction History** 
  - Search transactions 
  - Have a filter by date range option
  - Display rows of most recent transactions 
  - Export all data out to CSV
  - Create a repo of all recent uploads 
  - Allow transaction deletion
  - Allow bulk clear data for adjustable options

### Import Data
- **Import options** 
  - Support multiple CSV uploads or manual transaction entry.
  - Parse CSVs server-side using Supabase Edge Functions for efficiency.
  - Handle data from 2009 onward; store raw files in Supabase Storage.
  - Prompt Cursor: "Create a function to parse CSVs and insert into `transactions`."
  - Highlight supported format and what the file should include 


### Accounting Settings
- Allow users to manage subscriptions and cancel via Stripe API.
- Minimize stored user info (e.g., only `id`, `email` in Supabase).
- Sensitive data (e.g., billing info) maintained at Stripe level.


### Navigation
- **Sidebar:**
  - Links to Overview, Performance, Portfolio Details, Settings.
- **Drill-Down Links:**
  - Embed clickable elements in Overview linking to detailed sections.


### APIs
- **Stripe:** Manage subscriptions and cancellations (e.g., `app/api/stripe/cancel/route.ts`).
- **CoinGecko:**
  - Fetch real-time Bitcoin prices: `/simple/price?ids=bitcoin&vs_currencies=usd`.
  - Fetch historical prices: `/coins/bitcoin/history?date=DD-MM-YYYY`.
  - Cache prices in Supabase to respect rate limits (50 calls/min).

  
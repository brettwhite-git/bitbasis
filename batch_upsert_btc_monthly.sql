
-- Batch upsert all BTC monthly close data at once
INSERT INTO public.btc_monthly_close (date, close) 
VALUES 
    ('2010-07-31', 0.0611),
    ('2010-08-31', 0.0629),
    ('2010-09-30', 0.06197),
    ('2010-10-31', 0.1955),
    ('2010-11-30', 0.2275),
    ('2010-12-31', 0.3),
    ('2011-01-31', 0.7077),
    ('2011-02-28', 0.9202),
    ('2011-03-31', 0.7741),
    ('2011-04-30', 3.033),
    ('2011-05-31', 9.57),
    ('2011-06-30', 15.4),
    ('2011-07-31', 13.09),
    ('2011-08-31', 8.21),
    ('2011-09-30', 5.032),
    ('2011-10-31', 3.15),
    ('2011-11-30', 3.06),
    ('2011-12-31', 5.268),
    ('2012-01-31', 6.076),
    ('2012-02-29', 4.921),
    ('2012-03-31', 4.827),
    ('2012-04-30', 5),
    ('2012-05-31', 5.275),
    ('2012-06-30', 6.629),
    ('2012-07-31', 9.55),
    ('2012-08-31', 9.965),
    ('2012-09-30', 12.4),
    ('2012-10-31', 10.57),
    ('2012-11-30', 12.56),
    ('2012-12-31', 13.3),
    ('2013-01-31', 20.5),
    ('2013-02-28', 34.5),
    ('2013-03-31', 104),
    ('2013-04-30', 116.38),
    ('2013-05-31', 129.3),
    ('2013-06-30', 88.05),
    ('2013-07-31', 104),
    ('2013-08-31', 146.01),
    ('2013-09-30', 140.3),
    ('2013-10-31', 213.43),
    ('2013-11-30', 1004.39),
    ('2013-12-31', 815.94),
    ('2014-01-31', 940.42),
    ('2014-02-28', 557.39),
    ('2014-03-31', 463.45),
    ('2014-04-30', 460.13),
    ('2014-05-31', 649.79),
    ('2014-06-30', 643.19),
    ('2014-07-31', 598.78),
    ('2014-08-31', 477.19),
    ('2014-09-30', 382.84),
    ('2014-10-31', 325.43),
    ('2014-11-30', 378.61),
    ('2014-12-31', 314.89),
    ('2015-01-31', 225.29),
    ('2015-02-28', 257.94),
    ('2015-03-31', 246.24),
    ('2015-04-30', 233.21),
    ('2015-05-31', 223.14),
    ('2015-06-30', 257.62),
    ('2015-07-31', 280.47),
    ('2015-08-31', 227.18),
    ('2015-09-30', 237.05),
    ('2015-10-31', 322.95),
    ('2015-11-30', 361.8),
    ('2015-12-31', 433.99),
    ('2016-01-31', 372.18),
    ('2016-02-29', 434.04),
    ('2016-03-31', 415.64),
    ('2016-04-30', 452.24),
    ('2016-05-31', 537.4),
    ('2016-06-30', 674.57),
    ('2016-07-31', 607),
    ('2016-08-31', 571.99),
    ('2016-09-30', 613.41),
    ('2016-10-31', 726.76),
    ('2016-11-30', 752.63),
    ('2016-12-31', 995.44),
    ('2017-01-31', 982.43),
    ('2017-02-28', 1222.66),
    ('2017-03-31', 1086.12),
    ('2017-04-30', 1415.81),
    ('2017-05-31', 2412.65),
    ('2017-06-30', 2424.61),
    ('2017-07-31', 2746.99),
    ('2017-08-31', 4921.85),
    ('2017-09-30', 4403.09),
    ('2017-10-31', 6737.78),
    ('2017-11-30', 10861.47),
    ('2017-12-31', 13444.88),
    ('2018-01-31', 9114.72),
    ('2018-02-28', 10929.37),
    ('2018-03-31', 6835.84),
    ('2018-04-30', 9077.28),
    ('2018-05-31', 7530.55),
    ('2018-06-30', 6339.04),
    ('2018-07-31', 7610.9),
    ('2018-08-31', 7203.46),
    ('2018-09-30', 6594.98),
    ('2018-10-31', 6381.3),
    ('2018-11-30', 4197.46),
    ('2018-12-31', 3880.15),
    ('2019-01-31', 3461.63),
    ('2019-02-28', 3831.48),
    ('2019-03-31', 4151.32),
    ('2019-04-30', 5389.54),
    ('2019-05-31', 8555.87),
    ('2019-06-30', 10591.87),
    ('2019-07-31', 10409.79),
    ('2019-08-31', 9768.36),
    ('2019-09-30', 8326.64),
    ('2019-10-31', 9260.59),
    ('2019-11-30', 7420.53),
    ('2019-12-31', 7189.94),
    ('2020-01-31', 9384.45),
    ('2020-02-29', 8549.38),
    ('2020-03-31', 6663.63),
    ('2020-04-30', 8829.12),
    ('2020-05-31', 10211.23),
    ('2020-06-30', 9238.89),
    ('2020-07-31', 11812.42),
    ('2020-08-31', 11926.69),
    ('2020-09-30', 10622.79),
    ('2020-10-31', 13761.72),
    ('2020-11-30', 18792.03),
    ('2020-12-31', 29388.94),
    ('2021-01-31', 33535.94),
    ('2021-02-28', 49635.07),
    ('2021-03-31', 58730.82),
    ('2021-04-30', 57843.16),
    ('2021-05-31', 36683.51),
    ('2021-06-30', 33543.11),
    ('2021-07-31', 39870.76),
    ('2021-08-31', 48840.01),
    ('2021-09-30', 48164.35),
    ('2021-10-31', 60960.98),
    ('2021-11-30', 57227.97),
    ('2021-12-31', 47737.35),
    ('2022-01-31', 38721.49),
    ('2022-02-28', 44428.47),
    ('2022-03-31', 46299.75),
    ('2022-04-30', 38480.53),
    ('2022-05-31', 29789.58),
    ('2022-06-30', 19249.33),
    ('2022-07-31', 23271.57),
    ('2022-08-31', 20129.93),
    ('2022-09-30', 19313.96),
    ('2022-10-31', 20480.27),
    ('2022-11-30', 16978.64),
    ('2022-12-31', 16613.87),
    ('2023-01-31', 23730.52),
    ('2023-02-28', 23642.8),
    ('2023-03-31', 28468.49),
    ('2023-04-30', 28086.77),
    ('2023-05-31', 26825.73),
    ('2023-06-30', 30590.76),
    ('2023-07-31', 29699.74),
    ('2023-08-31', 25798.79),
    ('2023-09-30', 27994.51),
    ('2023-10-31', 35439.76),
    ('2023-11-30', 38699.84),
    ('2023-12-31', 44197.61),
    ('2024-01-31', 43073.2),
    ('2024-02-29', 62431.25),
    ('2024-03-31', 69686.37),
    ('2024-04-30', 58277.44),
    ('2024-05-31', 67721.6),
    ('2024-06-30', 62841.27),
    ('2024-07-31', 65300.21),
    ('2024-08-31', 57313.44),
    ('2024-09-30', 60790.06),
    ('2024-10-31', 69473.41),
    ('2024-11-30', 97276.47),
    ('2024-12-31', 94392.51),
    ('2025-01-31', 100619.87),
    ('2025-02-28', 86050.58),
    ('2025-03-31', 85174.96),
    ('2025-04-30', 96519.31),
    ('2025-05-31', 105702.19),
    ('2025-06-30', 105724.18),
    ('2025-07-31', 113263.48),
    ('2025-08-31', 109256.28)
ON CONFLICT (date) 
DO UPDATE SET 
    close = EXCLUDED.close,
    updated_at = NOW();

-- Verify the data was inserted
SELECT 
    COUNT(*) as total_records,
    MIN(date) as earliest_date,
    MAX(date) as latest_date,
    MIN(close) as min_price,
    MAX(close) as max_price
FROM public.btc_monthly_close;
